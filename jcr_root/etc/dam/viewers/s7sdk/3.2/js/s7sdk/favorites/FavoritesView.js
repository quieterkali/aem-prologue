/*!************************************************************************
*
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2015 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and are protected by trade secret or copyright law.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/
(function(b){b.pkg("s7sdk.favorites");b.Util.require("s7sdk.set.Swatches");if(!b.favorites.FavoritesViewControl){b.favorites.FavoritesViewControl=function(c){arguments.callee.superclass.apply(this,[c,b.favorites.FavoritesViewControl.NS,c.constructor,b.favorites.FavoritesView.RESTRICTED_STYLES])};b.favorites.FavoritesViewControl.NS="s7sdk.favorites.FavoritesViewControl";b.favorites.FavoritesViewControl.prototype.rebuild=function(d){var e=this.component.favorites;var c=this.component.globalMediaSet;this.superproto.rebuild.apply(this,[d]);this.component.setMediaSet(c);this.component.setFavorites(e)}}b.Class.inherits(b.favorites.FavoritesViewControl.NS,"s7sdk.ControlComponent");if(!b.favorites.FavoritesView){b.favorites.FavoritesView=function FavoritesView(c,e,d){b.Logger.log(b.Logger.CONFIG,"s7sdk.set.FavoritesView constructor - container: %0, settings: %1 , compId: %2",c,e,d);var h=!!arguments[3];d=(typeof d=="string"&&d.length)?d:"FavoritesView_"+b.Util.createUniqueId();arguments.callee.superclass.apply(this,[d,c,"div","s7favoritesview",e,!h]);this.container=this.getParent();this.favorites=[];this.globalMediaSet=null;this.createElement();this.attachToContainer();this.innerSwatches=new b.Swatches(d,e,d+"_swatches",true);this.innerSwatches.serverUrl=this.serverUrl;this.innerSwatches.iscommand=this.iscommand;this.innerSwatches.maxloadradius=this.maxloadradius;this.innerSwatches.textPos=this.textPos;this.innerSwatches.align=this.align;this.innerSwatches.fmt=this.fmt;this.innerSwatches.tmbLayout={cols:1,rows:0};this.innerSwatches.orientation=1;this.innerSwatches.enableScrollButtons=false;this.innerSwatches.resizable=false;var g=parseInt(b.Util.css.getCss("s7favoritesview","width",d,null,this.getParent()));var i=parseInt(b.Util.css.getCss("s7favoritesview","height",d,null,this.getParent()));this.resize(g,i);var f=this;this.innerSwatches.addEventListener(b.event.AssetEvent.SWATCH_SELECTED_EVENT,function(m){var k=m.s7event.frame;var j=f.favorites[k].frameIdx;var l=new b.event.AssetEvent(b.AssetEvent.ITEM_SELECTED_EVENT,f.globalMediaSet.items[j],j);f.dispatchEvent(l)});if(!h){return new b.favorites.FavoritesViewControl(this)}else{return this}};b.Class.inherits("s7sdk.favorites.FavoritesView","s7sdk.UIComponent");b.favorites.FavoritesView.prototype.modifiers={favoritesThumbArea:{params:["value"],defaults:[0.1],ranges:["0.0:1.0"]},serverUrl:{params:["isRootPath"],defaults:["/is/image/"]},iscommand:{params:["value"],defaults:[""],parseParams:false},maxloadradius:{params:["value"],defaults:[1],ranges:["-1:"]},textPos:{params:["textpos"],defaults:["bottom"],ranges:[["bottom","top","left","right","tooltip","none"]]},align:{params:["horizontal","vertical"],defaults:["center","center"],ranges:[["left","center","right"],["top","center","bottom"]]},fmt:{params:["fmt"],defaults:["jpg"],ranges:[["jpg","jpeg","png","png-alpha","gif","gif-alpha"]]}};b.favorites.FavoritesView.RESTRICTED_STYLES={s7favoritesview:["width","height"],"s7favoritesview s7swatches s7thumb":["width","height"],"s7favoritesview s7swatches s7thumbcell":["margin-left","margin-right","margin-top","margin-bottom"],"s7favoritesview s7swatches s7label":["font-family","font-size","font-style"]};b.favorites.FavoritesView.prototype.setCSS=function(e,d,c){if(this.isRestrictedCSSProperty(b.favorites.FavoritesView.RESTRICTED_STYLES,d)){throw new Error("You cannot set "+e+" : "+d+" CSS property for this component ")}else{this.superproto.setCSS.apply(this,[e,d,c])}};b.favorites.FavoritesView.prototype.setModifier=function(c){throw new Error("Trying to use setModifier on the Core class (FavoritesView) is unsupported! Please refer to SDK documentation on using setModifier.")};b.favorites.FavoritesView.prototype.addEventListener=function(e,d,c){b.Logger.log(b.Logger.FINE,"s7sdk.favorites.FavoritesView.addEventListener - type: %0, handler: %1, useCapture: %2",e,d.toString().substring(0,d.toString().indexOf("(")),c);this.superproto.addEventListener.apply(this,[e,d,c])};b.favorites.FavoritesView.prototype.setMediaSet=function(c){b.Logger.log(b.Logger.FINE,"s7sdk.favorites.FavoritesView.setMediaSet - mediaSet: %0, type: %1",c);this.globalMediaSet=c;this.favorites=[];this.innerSwatches.cleanUp()};b.favorites.FavoritesView.prototype.cleanUp=function(){this.globalMediaSet=null;this.favorites=[];this.innerSwatches.cleanUp();b.Util.removeTags(this.obj);this.obj.style.cssText=""};b.favorites.FavoritesView.prototype.dispose=function(){this.cleanUp();if(this.obj){if(this.obj.parentElement){this.obj.parentElement.removeChild(this.obj)}}};b.favorites.FavoritesView.prototype.setFavorites=function(c){if(JSON.stringify(this.favorites)==JSON.stringify(c)){return}this.favorites=c;var d=this.createFavoritesMediaSet();this.innerSwatches.setMediaSet(d)};b.favorites.FavoritesView.prototype.getFavorites=function(){return this.favorites};b.favorites.FavoritesView.prototype.createFavoritesMediaSet=function(k){var c=new b.MediaSetDesc();for(var i=0;i<this.favorites.length;i++){var h=this.globalMediaSet.items[this.favorites[i].frameIdx];var e={width:Math.round(h.width*this.favoritesThumbArea),height:Math.round(h.height*this.favoritesThumbArea)};var f=Math.min(e.width/this.innerSwatches.tmbSize.width,e.height/this.innerSwatches.tmbSize.height);var l={width:Math.round(this.innerSwatches.tmbSize.width*f),height:Math.round(this.innerSwatches.tmbSize.height*f)};var d={x:Math.round(this.favorites[i].x-l.width/2),y:Math.round(this.favorites[i].y-l.height/2),width:l.width,height:l.height};var g=new b.ImageDesc(h.parent,h.type,h.name+(h.name.indexOf("?")==-1?"?":"&")+"rgn="+d.x+","+d.y+","+d.width+","+d.height+"&wid="+this.innerSwatches.tmbSize.width+"&hei="+this.innerSwatches.tmbSize.height,h.swatch,h.width,h.height,h.version,h.isDefault,h.mod,h.pmod,h.label,null,null,null,(h.maps&&h.maps.length)?true:false,false,true);c.items.push(g)}return c};b.favorites.FavoritesView.prototype.getWidth=function(){return this.innerSwatches.getWidth()};b.favorites.FavoritesView.prototype.getHeight=function(){return this.innerSwatches.getHeight()};b.favorites.FavoritesView.prototype.resize=function(c,d){b.Logger.log(b.Logger.FINE,"s7sdk.favorites.FavoritesView.resize - width: %0, height: %1",c,d);this.obj.style.width=c+"px";this.obj.style.height=d+"px";this.innerSwatches.resize(c,d);b.UIComponent.prototype.resize.apply(this,[c,d])};b.favorites.FavoritesView.prototype.getFrame=function(){b.Logger.log(b.Logger.FINE,"s7sdk.favorites.FavoritesView.getFrame");return this.innerSwatches.getFrame()};b.favorites.FavoritesView.prototype.selectSwatch=function(c,d){b.Logger.log(b.Logger.FINE,"s7sdk.favorites.FavoritesView.selectSwatch - index: %0, triggerScroll: %1",c,d);this.innerSwatches.selectSwatch(c,d)};b.favorites.FavoritesView.prototype.hide=function(){b.Util.fade(this.obj,true,0.3,"block")};b.favorites.FavoritesView.prototype.show=function(){b.Util.fade(this.obj,false,0.3,"block")};b.FavoritesView=b.favorites.FavoritesView;(function a(){var e=b.Util.css.createCssRuleText;var d=b.Util.css.createCssImgUrlText;var c=e(".s7favoritesview",{position:"absolute",width:"100px",height:"250px"})+e(".s7favoritesview .s7swatches .s7thumbcell",{margin:"5px"})+e(".s7favoritesview .s7swatches .s7thumb",{border:"1px solid transparent",width:"75px",height:"75px"})+e(".s7favoritesview .s7swatches .s7thumb[state='selected']",{border:"1px solid #FFFFFF"})+e(".s7favoritesview .s7swatches .s7label",{"font-family":"Helvetica, sans-serif","font-size":"12px"});b.Util.css.addDefaultCSS(c,"FavoritesView")})()}})(s7getCurrentNameSpace());