/*!************************************************************************
*
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2011 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and are protected by trade secret or copyright law.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/
(function(b){b.pkg("s7sdk.image");b.Util.require("s7sdk.common.IS");b.Util.require("s7sdk.common.ScrollableDiv");b.Util.require("s7sdk.common.Thumb");b.Util.require("s7sdk.utils.SwatchesParser");b.Util.require("s7sdk.common.ItemDesc");b.Util.require("s7sdk.common.Geometry");b.Util.require("s7sdk.common.Button");b.Util.require("s7sdk.event.Event");if(!b.image.ZoomTargets){b.image.ZoomTargets=function ZoomTargets(f,k,p){b.Logger.log(b.Logger.CONFIG,"s7sdk.image.ZoomTargets constructor - container: %0, settings: %1 , compId: %2",f,k,p);p=(typeof p=="string"&&p.length)?p:"Targets_"+b.Util.createUniqueId();arguments.callee.superclass.apply(this,[p,f,"div","s7zoomtargets",k]);this.container=this.getParent();this.BTN_LEFT_SIDE="leftSide";this.BTN_RIGHT_SIDE="rightSide";this.BTN_TOP_SIDE="topSide";this.BTN_BOTTOM_SIDE="bottomSide";this.SCROLL_BUTTON_TAP="tap";this.SCROLL_BUTTON_HOLD="hold";this.mediaSet=null;if(this.serverUrl.lastIndexOf("/")!=(this.serverUrl.length-1)){this.serverUrl+="/"}var d="";this.asset=unescape(this.asset);if(this.asset.indexOf("?")>=0){d=this.asset.substring(this.asset.indexOf("?")+1);this.asset=this.asset.substring(0,this.asset.indexOf("?"))}this.iscommand=(d.length>0?"&":"")+this.iscommand;if(this.border.color.indexOf("#")<0){this.border.color="#"+this.border.color}if(this.size.width==0||this.size.height==0){this.size.width=parseInt(b.Util.css.getCss("s7zoomtargets","width",p,null,this.container));this.size.height=parseInt(b.Util.css.getCss("s7zoomtargets","height",p,null,this.container));if(!b.Util.isNumber(this.size.width)||!b.Util.isNumber(this.size.height)||this.size.width<=0||this.size.height<=0){this.size.width=300;this.size.height=95}}this.totalWidth=this.size.width;this.totalHeight=this.size.height;this.size.width=this.size.width-this.border.thickness*2;this.size.height=this.size.height-this.border.thickness*2;var j=parseInt(b.Util.css.getCss("s7thumb","width",this.id,"s7zoomtargets",this.container));var h=parseInt(b.Util.css.getCss("s7thumb","height",this.id,"s7zoomtargets",this.container));this.tmbWid=(j>0&&j<this.size.width)?j:75;this.tmbHei=(h>0&&h<this.size.height)?h:75;this.tmbWid=(this.tmbSize.width!=75)?this.tmbSize.width:this.tmbWid;this.tmbHei=(this.tmbSize.height!=75)?this.tmbSize.height:this.tmbHei;this.maxTmbWid=this.tmbWid;this.maxTmbHei=this.tmbHei;if(typeof this.getParam("cellspacing")!="undefined"){}else{var g=0;var c=0;var m=0;var e=0;var o=["margin-left","margin-right"];var n=["margin-top","margin-bottom"];for(var l=0;l<o.length;l++){m=parseInt(b.Util.css.getCss("s7thumbcell",o[l],this.id,"s7zoomtargets",this.container));if(b.Util.isNumber(m)){g+=m}}for(var l=0;l<n.length;l++){e=parseInt(b.Util.css.getCss("s7thumbcell",n[l],this.id,"s7zoomtargets",this.container));if(b.Util.isNumber(e)){c+=e}}g=isNaN(g)?0:g;c=isNaN(c)?0:c;this.cellSpacing.horizontal=g;this.cellSpacing.vertical=c}this.rollover=false;this.buttonBehavior=this.SCROLL_BUTTON_TAP;this.scrollVelocity=600;this.delay=1;this.locale=this.getParam("locale","");this.interval=this.getParam("interval",20);this.leftButton_=null;this.rightButton_=null;this.upButton_=null;this.downButton_=null;this.buttonSize_=Math.max.apply(null,[["s7scrollleftbutton","width"],["s7scrollrightbutton","width"],["s7scrollupbutton","height"],["s7scrolldownbutton","height"]].map(function(i){return parseInt(b.Util.css.getCss(i[0],i[1],this.id,"s7zoomtargets",this.container))},this))||0;this.fitCols_=NaN;this.fitRows_=NaN;this.assetName_=null;this.isReq_=null;this.targets=[];this.itemsArray_=[];this.swatchGroup_=null;this.scrollParentDiv=null;this.swatchGroupRect_=null;this.currentSwatch_=null;this.itemIndex_=-1;this.createElement();this.setAsset(this.asset)};b.Class.inherits("s7sdk.image.ZoomTargets","s7sdk.UIComponent");b.image.ZoomTargets.prototype.modifiers={serverUrl:{params:["isRootPath"],defaults:["/is/image/"]},asset:{params:["asset"],defaults:[""],parseParams:false},iscommand:{params:["value"],defaults:[""],parseParams:false},tmbLayout:{params:["cols","rows"],defaults:[0,1],ranges:["0:","0:"]},cellSpacing:{params:["horizontal","vertical"],defaults:[10,10],ranges:["0:","0:"],deprecated:true},textPos:{params:["position"],defaults:["bottom"],ranges:[["bottom","top","left","right","tooltip","none"]]},resizable:{params:["resizable"],defaults:[false]},pageMode:{params:["pagemode"],defaults:[false]},enableScrollButtons:{params:["enable"],defaults:[true]},scrollStep:{params:["hStep","vStep"],defaults:[3,3],ranges:["0:","0:"]},enableDragging:{params:["enabled","overdragvalue"],defaults:[true,0.5,0],ranges:[,"0:1"]},buttonSnapMode:{params:["mode"],defaults:["snapin"],ranges:[["snapin","snapout","overlay"]]},partialSwatches:{params:["enable"],defaults:[false]},orientation:{params:["rowMajor"],defaults:[false]},tmbSize:{params:["width","height"],defaults:[75,75],ranges:["0:","0:"],deprecated:true},size:{params:["width","height"],defaults:[0,0],ranges:["0:","0:"],deprecated:true},border:{params:["color","thickness"],defaults:["#cccccc",1],deprecated:true},fmt:{params:["fmt"],defaults:["jpg"],ranges:[["jpg","jpeg","png","png-alpha","gif","gif-alpha"]]},highlight:{params:["color","value"],defaults:["#3366CC",-1],deprecated:true}};b.image.ZoomTargets.prototype.setAsset=function(d){b.Logger.log(b.Logger.FINE,"s7sdk.image.ZoomTargets.setAsset - assetName: %0",d);var c=unescape(d);this.itemIndex_=-1;this.itemsArray_=[];this.mediaSet=null;this.assetName_=c;this.loadAsset()};b.image.ZoomTargets.prototype.getContainer=function(){return this.getParent()};b.image.ZoomTargets.prototype.build=function(){this.attachToContainer();this.initTargets();this.layoutSwatches();this.obj.insertBefore(this.scrollParentDiv,this.obj.firstChild);if(this.itemIndex_!=-1){this.selectTarget(this.itemIndex_,true)}};b.image.ZoomTargets.prototype.cleanUp=function(){if(this.isReq_){this.isReq_.cancelHttpReq();this.isReq_=null}this.targets=[];this.currentSwatch_=null;if(this.scrollParentDiv!=null){if(this.swatchGroup_){this.swatchGroup_.dispose()}this.obj.removeChild(this.scrollParentDiv);this.scrollParentDiv=null;this.swatchGroup_=null}if(this.obj!=null&&this.obj.parentNode!=null){this.obj.parentNode.removeChild(this.obj)}c(this.leftButton_);c(this.rightButton_);c(this.upButton_);c(this.downButton_);function c(d){if(d&&d.obj&&d.obj.parentNode){d.obj.parentNode.removeChild(d.obj)}}};b.image.ZoomTargets.prototype.loadAsset=function(){var c=this.serverUrl+"/"+this.assetName_;if(c.indexOf("?")==-1){c+="?req=set,json"}else{c+="&req=set,json"}if(b.Util.isNonEmptyString(this.locale)){c+="&locale="+this.locale}b.Logger.log(b.Logger.INFO,"s7sdk.image.ZoomTargets.loadAsset - req: %0",c);this.isReq_=new b.IS(this.serverUrl,this.assetName_);this.isReq_.getHttpReq(c,function(e,d){b.image.ZoomTargets.prototype.requestComplete.apply(d,[e])},function(e,d){b.Logger.log(b.Logger.WARNING,"s7sdk.image.ZoomTargets - image load error: "+e.message)},this)};b.image.ZoomTargets.prototype.requestComplete=function(c){b.Logger.log(b.Logger.FINER,"s7sdk.image.ZoomTargets.requestComplete");if(c.set==null||c.set.type=="empty"){b.Logger.log(b.Logger.FINER,"s7sdk.image.ZoomTargets - instantiated without an asset, doing nothing.");return}var d=b.MediaSetParser.parse(c.set);if(d.items.length>0){this.setItem(d.items[0])}};b.image.ZoomTargets.prototype.setItem=function(d){if(d instanceof b.ItemDesc==false){throw new Error("Item must be a descendant of ItemDesc!")}if(d.parent==null){throw new Error("ItemDesc must be part of a parent set!")}b.Logger.log(b.Logger.FINE,"s7sdk.image.ZoomTargets.setItem - item: %0",d);this.cleanUp();this.mediaSet=d.parent;this.assetName_=d.name;this.itemIndex_=-1;var c=[];if(this.mediaSet.targets){c=c.concat(this.mediaSet.targets)}if(d.targets){c=c.concat(d.targets)}if(c.length==0){return}this.itemsArray_=c;this.build()};b.image.ZoomTargets.prototype.initTargets=function(){var e=0;var f;var c;for(var d=0;d<this.itemsArray_.length;d++){f=this.itemsArray_[d];f.image=this.assetName_;c=new b.Thumb(this.obj,this.serverUrl,this.iscommand,f,this.tmbWid,this.tmbHei,this.fmt,this.highlight.value,this.highlight.color,f.rect,this.textPos,this.cl,this.locale);this.maxTmbWid=(c.getWidth()<this.maxTmbWid)?this.maxTmbWid:c.getWidth();this.maxTmbHei=(c.getHeight()<this.maxTmbHei)?this.maxTmbHei:c.getHeight();if(!f.hasOwnProperty("frame")){f.frame=e++}this.targets[f.frame]=c}};b.image.ZoomTargets.prototype.resize=function(d,c){b.Logger.log(b.Logger.FINE,"s7sdk.image.ZoomTargets.resize - width: %0, height: %1",d,c);this.totalWidth=d;this.totalHeight=c;this.size.width=d-this.border.thickness*2;this.size.height=c-this.border.thickness*2;this.obj.setWidth(this.totalWidth);this.obj.setHeight(this.totalHeight);this.cleanUp();this.build();b.UIComponent.prototype.resize.apply(this,[d,c])};b.image.ZoomTargets.prototype.layoutSwatches=function(){var c=(!this.resizable&&this.enableScrollButtons&&this.buttonSnapMode!="overlay"&&this.buttonSize_)?this.buttonSize_:0;if(this.size.width!=0){var o=Math.floor((this.size.width-this.cellSpacing.horizontal)/(this.maxTmbWid+this.cellSpacing.horizontal));if(this.tmbLayout.cols!=0&&this.tmbLayout.cols<=o){o=this.tmbLayout.cols}}else{o=this.tmbLayout.cols}if(this.size.height!=0){var n=Math.floor((this.size.height-this.cellSpacing.vertical)/(this.maxTmbHei+this.cellSpacing.vertical));if(this.tmbLayout.rows!=0&&this.tmbLayout.rows<=n){n=this.tmbLayout.rows}}else{n=this.tmbLayout.rows}this.fitCols_=o;this.fitRows_=n;while(o*n<this.targets.length&&(this.tmbLayout.cols==0||this.tmbLayout.rows==0||o<this.tmbLayout.cols||n<this.tmbLayout.rows)){if(this.orientation==0){if(this.tmbLayout.cols==0||o<this.tmbLayout.cols){o++}if(n==0||(n*o<this.targets.length&&(this.tmbLayout.rows==0||n<this.tmbLayout.rows))){n++}}else{if(this.tmbLayout.rows==0||n<this.tmbLayout.rows){n++}if(o==0||(n*o<this.targets.length&&(this.tmbLayout.cols==0||o<this.tmbLayout.cols))){o++}}}if(o>this.fitCols_){this.fitCols_=Math.floor((this.size.width-this.cellSpacing.horizontal-2*c)/(this.maxTmbWid+this.cellSpacing.horizontal))}if(n>this.fitRows_){this.fitRows_=Math.floor((this.size.height-this.cellSpacing.vertical-2*c)/(this.maxTmbHei+this.cellSpacing.vertical))}if(!this.resizable&&(this.fitCols_<=0||this.fitRows_<=0)){b.Logger.log(b.Logger.WARNING,"s7sdk.image.ZoomTargets.layoutSwatches - Cannot fit any swatches into the given area: width %0, height %1",this.size.width,this.size.height);this.createScrollParentDiv(0,0)}var F=NaN;var C=NaN;var v=0;var r=0;var B=0;var A=0;var y=NaN;var s;this.swatchGroup_=new b.ScrollableDiv(this,this.enableDragging.enabled,new b.Point2D(this.fitCols_*(this.cellSpacing.horizontal+this.maxTmbWid),this.fitRows_*(this.cellSpacing.vertical+this.maxTmbHei)),this.interval,null,this.enableDragging.overdragvalue,this.pageMode);var g=[];for(y=0;y<this.targets.length&&y<o*n;y++){if(this.orientation==0){F=Math.floor(y/o);C=y%o;g[y]={col:C,row:F}}else{C=Math.floor(y/n);F=y%n;g[y]={col:C,row:F}}v=(v<F)?F:v;r=(r<C)?C:r}v++;r++;if(this.pageMode){var z=Math.ceil(r/this.fitCols_);var E=Math.ceil(v/this.fitRows_);g=[];if(this.orientation==0){for(var x=0;x<z;x++){for(var y=0;y<E;y++){var D=(x+y*z)*(this.fitRows_*this.fitCols_);for(var w=0;w<this.fitCols_;w++){for(var t=0;t<this.fitRows_;t++){var p=w+t*this.fitCols_+D;g[p]={col:w+x*this.fitCols_,row:t+y*this.fitRows_}}}}}}else{for(var x=0;x<E;x++){for(var y=0;y<z;y++){var D=(x+y*E)*(this.fitRows_*this.fitCols_);for(var w=0;w<this.fitRows_;w++){for(var t=0;t<this.fitCols_;t++){var p=w+t*this.fitRows_+D;g[p]={col:t+y*this.fitCols_,row:w+x*this.fitRows_}}}}}}}for(y=0;y<this.targets.length&&y<o*n;y++){s=this.targets[y];s.x=g[y].col*(this.maxTmbWid+this.cellSpacing.horizontal);if(this.textPos==b.Thumb.TEXT_LEFT){s.x+=this.maxTmbWid-s.getWidth()}s.y=g[y].row*(this.maxTmbHei+this.cellSpacing.vertical);if(this.textPos==b.Thumb.TEXT_TOP){s.y+=this.maxTmbHei-s.getHeight()}this.swatchGroup_.div.appendChild(s.div);s.div.style.position="absolute";s.updatePosition();function u(i,j){b.Event.addDOMListener(j.div,"click",function(k){i.onSwatchClicked(k,j)},true);b.Event.addDOMListener(j.div,"touchend",function(k){i.onSwatchClicked(k,j)},true)}u(this,s);if(B<s.x){B=s.x}if(A<s.y){A=s.y}}var f=0;var h=0;if(this.pageMode){this.swatchGroup_.xNotch=this.fitCols_*(this.cellSpacing.horizontal+this.maxTmbWid);this.swatchGroup_.yNotch=this.fitRows_*(this.cellSpacing.vertical+this.maxTmbHei);var q=(o%this.fitCols_);var d=(n%this.fitRows_);if(q){f=this.fitCols_-q}if(d){h=this.fitRows_-d}this.scrollStep.hStep=this.fitCols_;this.scrollStep.vStep=this.fitRows_}else{if(!this.partialSwatches){this.swatchGroup_.xNotch=(this.cellSpacing.horizontal+this.maxTmbWid);this.swatchGroup_.yNotch=(this.cellSpacing.vertical+this.maxTmbHei)}else{this.swatchGroup_.xNotch=1;this.swatchGroup_.xNotch=1}}var e=this.cellSpacing.horizontal+r*(this.cellSpacing.horizontal+this.maxTmbWid);var l=this.cellSpacing.vertical+v*(this.cellSpacing.vertical+this.maxTmbHei);this.swatchGroup_.setLogicalWidth(B+this.cellSpacing.horizontal+this.maxTmbWid);this.swatchGroup_.setLogicalHeight(A+this.cellSpacing.vertical+this.maxTmbHei);if(this.resizable){this.obj.setWidth(e+this.border.thickness*2);this.obj.setHeight(l+this.border.thickness*2);this.createScrollParentDiv(e,l);this.scrollParentDiv.appendChild(this.swatchGroup_.div);this.scrollParentDiv.setX((e+this.border.thickness*2-e)/2);this.scrollParentDiv.setY((l+this.border.thickness*2-l)/2)}else{this.swatchGroupRect_=new b.Rectangle(0,0,Math.max(Math.min(this.swatchGroup_.scrollBounds.x,e),0),Math.max(Math.min(this.swatchGroup_.scrollBounds.y,l),0));this.createScrollParentDiv(this.swatchGroupRect_.width,this.swatchGroupRect_.height);this.scrollParentDiv.appendChild(this.swatchGroup_.div);this.scrollParentDiv.setX((this.totalWidth-this.swatchGroupRect_.width)/2);this.scrollParentDiv.setY((this.totalHeight-this.swatchGroupRect_.height)/2);this.layoutButtons()}this.swatchGroup_.layout()};b.image.ZoomTargets.prototype.onSwatchClicked=function(d,c){if(this.swatchGroup_.getInterpretAsClick()||this.rollover){this.itemIndex_=c.item.frame;this.applyTargetSelection(c,false,true)}};b.image.ZoomTargets.prototype.applyTargetSelection=function(k,d,e){d=typeof(d)=="undefined"?false:d;e=typeof(e)=="undefined"?false:e;if(this.currentSwatch_){this.currentSwatch_.setSelected(false)}this.currentSwatch_=k;this.currentSwatch_.setSelected(true);if(d){var h=0;var f=0;var j=this.swatchGroup_.scrollBounds.x/2;var i=this.swatchGroup_.scrollBounds.y/2;if(k.x>j&&k.x<(this.swatchGroup_.getLogicalWidth()-j)){h=-k.x+j}else{if(k.x>=(this.swatchGroup_.getLogicalWidth()-j)){h=-this.swatchGroup_.getLogicalWidth()+this.swatchGroup_.scrollBounds.x}}if(k.y>i&&k.y<(this.swatchGroup_.getLogicalHeight()-i)){f=-k.y+i}else{if(k.y>=(this.swatchGroup_.getLogicalHeight()-i)){f=-this.swatchGroup_.getLogicalHeight()+this.swatchGroup_.scrollBounds.y}}var l=this;function g(){if(l.swatchGroup_){l.swatchGroup_.slideTo(new b.Point2D(h,f))}}setTimeout(g,100)}this.dispatchEvent(new b.event.ZoomTargetEvent(b.event.ZoomTargetEvent.ZOOM_TARGET,-1,k.item.frame,k.item,k.sourceRect));var c=new b.event.UserEvent(b.event.UserEvent.TARG,[k.item.frame,k.item.label?k.item.label:""],true);b.Event.dispatch(this.obj,c,false)};b.image.ZoomTargets.prototype.addEventListener=function(e,d,c){b.Logger.log(b.Logger.FINE,"s7sdk.image.ZoomTargets.addEventListener - type: %0, handler: %1, useCapture: %2",e,d.toString().substring(0,d.toString().indexOf("(")),c);b.Base.prototype.addEventListener.apply(this,[e,d,c])};b.image.ZoomTargets.prototype.selectTarget=function(c,e){b.Logger.log(b.Logger.FINE,"s7sdk.image.ZoomTargets.selectTarget - targetDesc: %0, triggerScroll: %1",c,e);e=typeof(e)=="undefined"?true:e;for(var d=0;d<this.itemsArray_.length;d++){var f=this.itemsArray_[d];if(f.label==c.label&&f.rect.toString()==c.rect.toString()){break}}if(d==this.itemsArray_.length){throw new Error("Could not identify internal target based upon input target!;")}this.itemIndex_=d;if(this.targets[d]!=null){this.applyTargetSelection(this.targets[d],e)}};b.image.ZoomTargets.prototype.placeButton=function(d,e,c){var f=new b.Rectangle(0,0,this.buttonSize_,this.buttonSize_);switch(c){case this.BTN_LEFT_SIDE:d.x=e.x;d.y=e.y+(e.height-f.height)/2;break;case this.BTN_RIGHT_SIDE:d.x=e.getRight()-f.width;d.y=e.y+(e.height-f.height)/2;break;case this.BTN_TOP_SIDE:d.x=e.x+(e.width-f.width)/2;d.y=e.y;break;case this.BTN_BOTTOM_SIDE:d.x=e.x+(e.width-f.width)/2;d.y=e.getBottom()-f.height;break}d.x-=f.x;d.y-=f.y;d.obj.style.position="absolute";d.obj.style.left=d.x+"px";d.obj.style.top=d.y+"px"};b.image.ZoomTargets.prototype.layoutButtons=function(){var e;var d=this.scrollParentDiv.getX();var f=this.scrollParentDiv.getY();switch(this.buttonSnapMode){default:case"overlay":e=new b.Rectangle(d+5,f+5,this.swatchGroup_.scrollBounds.x-10,this.swatchGroup_.scrollBounds.y-10);break;case"snapin":e=new b.Rectangle(d-this.buttonSize_-2,f-this.buttonSize_-2,this.swatchGroup_.scrollBounds.x+2*this.buttonSize_+4,this.swatchGroup_.scrollBounds.y+2*this.buttonSize_+4);break;case"snapout":e=new b.Rectangle(2+this.border.thickness,2+this.border.thickness,this.size.width-4,this.size.height-4);break}if(this.swatchGroup_.getLogicalWidth()>this.swatchGroup_.scrollBounds.x&&this.fitCols_){this.swatchGroup_.scrollX=true;if(this.enableScrollButtons){this.leftButton_=new b.ScrollLeftButton(this.obj.id,this.settings,"leftButton_"+b.Util.createUniqueId());this.rightButton_=new b.ScrollRightButton(this.obj.id,this.settings,"rightButton_"+b.Util.createUniqueId());this.placeButton(this.leftButton_,e,this.BTN_LEFT_SIDE);this.placeButton(this.rightButton_,e,this.BTN_RIGHT_SIDE);var c=this;b.Event.addDOMListener(this.leftButton_,"mouseup",function(g){g=g||window.event;c.buttonClick(g,c.leftButton_)});b.Event.addDOMListener(this.leftButton_,"touchend",function(g){g=g||window.event;c.buttonClick(g,c.leftButton_)});b.Event.addDOMListener(this.rightButton_,"mouseup",function(g){g=g||window.event;c.buttonClick(g,c.rightButton_)});b.Event.addDOMListener(this.rightButton_,"touchend",function(g){g=g||window.event;c.buttonClick(g,c.rightButton_)})}}if(this.swatchGroup_.getLogicalHeight()>this.swatchGroup_.scrollBounds.y&&this.fitRows_){this.swatchGroup_.scrollY=true;if(this.enableScrollButtons){this.upButton_=new b.ScrollUpButton(this.obj.id,this.settings,"upButton_"+b.Util.createUniqueId());this.downButton_=new b.ScrollDownButton(this.obj.id,this.settings,"downButton_"+b.Util.createUniqueId());this.placeButton(this.upButton_,e,this.BTN_TOP_SIDE);this.placeButton(this.downButton_,e,this.BTN_BOTTOM_SIDE);var c=this;b.Event.addDOMListener(this.upButton_,"mouseup",function(g){g=g||window.event;c.buttonClick(g,c.upButton_)});b.Event.addDOMListener(this.upButton_,"touchend",function(g){g=g||window.event;c.buttonClick(g,c.upButton_)});b.Event.addDOMListener(this.downButton_,"mouseup",function(g){g=g||window.event;c.buttonClick(g,c.downButton_)});b.Event.addDOMListener(this.downButton_,"touchend",function(g){g=g||window.event;c.buttonClick(g,c.downButton_)})}}};b.image.ZoomTargets.prototype.buttonClick=function(d,c){if(this.buttonBehavior==this.SCROLL_BUTTON_HOLD){return}if(!c.activated){return}var g=Math.floor(this.scrollStep.hStep*(this.cellSpacing.horizontal+this.maxTmbWid));var e=Math.floor(this.scrollStep.vStep*(this.cellSpacing.vertical+this.maxTmbHei));var h=NaN;var f=NaN;if(c===this.leftButton_){h=this.swatchGroup_.getScrollDest().x+g}if(c===this.rightButton_){h=this.swatchGroup_.getScrollDest().x-g}if(c===this.upButton_){f=this.swatchGroup_.getScrollDest().y+e}if(c===this.downButton_){f=this.swatchGroup_.getScrollDest().y-e}if(!isNaN(h)){if(h>=0){h=0}if(h<=this.swatchGroupRect_.width-this.swatchGroup_.getLogicalWidth()){h=this.swatchGroupRect_.width-this.swatchGroup_.getLogicalWidth()}this.swatchGroup_.slideTo(new b.Point2D(h,this.swatchGroup_.getY()))}if(!isNaN(f)){if(f>=0){f=0}if(f<=this.swatchGroupRect_.height-this.swatchGroup_.getLogicalHeight()){f=this.swatchGroupRect_.height-this.swatchGroup_.getLogicalHeight()}this.swatchGroup_.slideTo(new b.Point2D(this.swatchGroup_.getX(),f))}};b.image.ZoomTargets.prototype.toggleLeftButton=function(c){if(this.leftButton_){c?this.leftButton_.activate():this.leftButton_.deactivate()}};b.image.ZoomTargets.prototype.toggleRightButton=function(c){if(this.rightButton_){c?this.rightButton_.activate():this.rightButton_.deactivate()}};b.image.ZoomTargets.prototype.toggleUpButton=function(c){if(this.upButton_){c?this.upButton_.activate():this.upButton_.deactivate()}};b.image.ZoomTargets.prototype.toggleDownButton=function(c){if(this.downButton_){c?this.downButton_.activate():this.downButton_.deactivate()}};b.image.ZoomTargets.prototype.getWidth=function(){return this.totalWidth};b.image.ZoomTargets.prototype.getHeight=function(){return this.totalHeight};b.image.ZoomTargets.prototype.getDiv=function(){return this.obj};b.image.ZoomTargets.prototype.getFrame=function(){b.Logger.log(b.Logger.FINE,"s7sdk.image.ZoomTargets.getFrame");return this.itemIndex_};b.image.ZoomTargets.prototype.createElement=function(){b.UIComponent.prototype.createElement.apply(this,[]);this.obj=this.prepareDiv(this.obj);this.obj.setWidth(this.totalWidth);this.obj.setHeight(this.totalHeight);this.obj.className="s7zoomtargets";this.obj.style.position="absolute"};b.image.ZoomTargets.prototype.createScrollParentDiv=function(d,c){if(this.scrollParentDiv==null){this.scrollParentDiv=this.prepareDiv();this.scrollParentDiv.setWidth(d);this.scrollParentDiv.setHeight(c);this.scrollParentDiv.style.position="absolute";this.scrollParentDiv.style.overflow="hidden"}};b.image.ZoomTargets.prototype.prepareDiv=function(c){var d=(c&&typeof c!="undefined")?c:document.createElement("div");d.getX=function(){return d.x_};d.getY=function(){return d.y_};d.setX=function(e){d.x_=e;d.style.left=e+"px"};d.setY=function(e){d.y_=e;d.style.top=e+"px"};d.getWidth=function(){return d.width_};d.getHeight=function(){return d.height_};d.setWidth=function(e){d.width_=e;d.style.width=e+"px"};d.setHeight=function(e){d.height_=e;d.style.height=e+"px"};return d};b.image.ZoomTargets.prototype.setModifier=function(c){throw new Error("Trying to use setModifier on the Core class (ZoomTargets) is unsupported! Please refer to SDK documentation on using setModifier.")};b.ZoomTargets=b.image.ZoomTargets;b.image.ZoomTargets.prototype.setCSS=function(e,d,c){this.superclass.superclass.prototype.setCSS.apply(this,[e,d,c])};(function a(){var g=b.Util.css.createCssRuleText;var d=b.Util.css.createCssImgUrlText;var e=b.browser&&b.browser.name=="ie"&&b.browser.version.major<=8;var f={display:"block",position:"absolute",top:"0px",left:"0px",width:"20px",height:"20px"};var c=g(".s7zoomtargets",{"background-color":e?"rgb(224, 224, 224)":"rgba(100, 100, 100, 0.2)","z-index":"0","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none","-webkit-user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)",width:"400px",height:"150px"})+g(".s7zoomtargets .s7thumbcell",{margin:"5px"})+g(".s7zoomtargets .s7thumb",{border:"1px solid transparent",width:"75px",height:"75px"})+g(".s7zoomtargets .s7thumb[state='selected']",{border:"1px solid #FFFFFF"})+g(".s7zoomtargets .s7scrollleftbutton",f)+g(".s7zoomtargets .s7scrollleftbutton[state='up']",{"background-image":d("scroll_left_up.png")})+g(".s7zoomtargets .s7scrollleftbutton[state='over']",{"background-image":d("scroll_left_over.png")})+g(".s7zoomtargets .s7scrollleftbutton[state='down']",{"background-image":d("scroll_left_down.png")})+g(".s7zoomtargets .s7scrollleftbutton[state='disabled']",{"background-image":d("scroll_left_disabled.png")})+g(".s7zoomtargets .s7scrollrightbutton",f)+g(".s7zoomtargets .s7scrollrightbutton[state='up']",{"background-image":d("scroll_right_up.png")})+g(".s7zoomtargets .s7scrollrightbutton[state='over']",{"background-image":d("scroll_right_over.png")})+g(".s7zoomtargets .s7scrollrightbutton[state='down']",{"background-image":d("scroll_right_down.png")})+g(".s7zoomtargets .s7scrollrightbutton[state='disabled']",{"background-image":d("scroll_right_disabled.png")})+g(".s7zoomtargets .s7scrollupbutton",f)+g(".s7zoomtargets .s7scrollupbutton[state='up']",{"background-image":d("scroll_up_up.png")})+g(".s7zoomtargets .s7scrollupbutton[state='over']",{"background-image":d("scroll_up_over.png")})+g(".s7zoomtargets .s7scrollupbutton[state='down']",{"background-image":d("scroll_up_down.png")})+g(".s7zoomtargets .s7scrollupbutton[state='disabled']",{"background-image":d("scroll_up_disabled.png")})+g(".s7zoomtargets .s7scrolldownbutton",f)+g(".s7zoomtargets .s7scrolldownbutton[state='up']",{"background-image":d("scroll_down_up.png")})+g(".s7zoomtargets .s7scrolldownbutton[state='over']",{"background-image":d("scroll_down_over.png")})+g(".s7zoomtargets .s7scrolldownbutton[state='down']",{"background-image":d("scroll_down_down.png")})+g(".s7zoomtargets .s7scrolldownbutton[state='disabled']",{"background-image":d("scroll_down_disabled.png")})+g(".s7zoomtargets .s7label",{"box-sizing":"border-box",padding:"3px",font:"14px Helvetica, Arial","text-shadow":"0px 4px 4px #555555"});b.Util.css.addDefaultCSS(c,"ZoomTargets")})()}})(s7getCurrentNameSpace());