/*!************************************************************************
*
*
*
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2012 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and are protected by trade secret or copyright law.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/
(function(b){b.pkg("s7sdk.image");b.Util.require("s7sdk.common.IS");b.Util.require("s7sdk.image.FlyoutView");b.Util.require("s7sdk.common.ItemDesc");if(!b.image.FlyoutZoomViewControl){b.image.FlyoutZoomViewControl=function(c){arguments.callee.superclass.apply(this,[c,b.image.FlyoutZoomViewControl.NS,c.constructor,b.image.FlyoutZoomView.RESTRICTED_STYLES])};b.image.FlyoutZoomViewControl.NS="s7sdk.image.FlyoutZoomViewControl";b.image.FlyoutZoomViewControl.prototype.rebuild=function(c){if(this.component){this.component.prepareUnload();this.superproto.rebuild.apply(this,[c])}}}b.Class.inherits(b.image.FlyoutZoomViewControl.NS,"s7sdk.ControlComponent");if(!b.image.FlyoutZoomView){b.image.FlyoutZoomView=function FlyoutZoomView(c,e,d){var g=!!arguments[3];d=(typeof d=="string"&&d.length)?d:"Flyout_"+b.Util.createUniqueId();arguments.callee.superclass.apply(this,[d,c,"div","s7flyoutzoomview",e,!g]);this.createElement();this.compSize={};this.devicePixelRatio=("devicePixelRatio" in window)?window.devicePixelRatio:1;this.container=this.getParent();if(this.serverUrl.lastIndexOf("/")!=(this.serverUrl.length-1)){this.serverUrl+="/"}this.compId=(b.Util.isNull(d)?"":d);this.asset=unescape(this.asset);this.imageModifier="";this.frame=-1;this.mediaSet=null;this.initialSize=null;this.initialFlyoutSize=null;this.adjustedZoomFactors={primaryFactor:-1,secondaryFactor:-1};if(typeof this.getParam("flyouttransition")!="undefined"){this.transition.type=this.flyouttransition.type;this.transition.duration={showTime:this.flyouttransition.showtime,showDelay:this.flyouttransition.showdelay,hideTime:this.flyouttransition.hidetime,hideDelay:this.flyouttransition.hidedelay}}else{this.transition.type=this.transition.type;this.transition.duration={showTime:this.transition.duration,showDelay:0,hideTime:this.transition.duration,hideDelay:0}}if(this.transition.type==b.image.FlyoutZoomView.ANIM_NONE){this.transition.duration={showTime:0.001,showDelay:this.flyouttransition.showdelay,hideTime:0.001,hideDelay:this.flyouttransition.hidedelay}}this.url="";this.attachToContainer();if(this.flyout){this.flyoutPos=new b.Rectangle(this.flyout.x,this.flyout.y,this.flyout.w,this.flyout.h)}else{this.flyoutPos=new b.Rectangle(0,0,0,0)}this.mainViewPos=new b.Rectangle(0,0,0,0);this.mainViewSizePreparation();this.flyoutView=new b.FlyoutView(this);this.breakpoints=null;this.bubble_desktop=this.getLocalizedText("TIP_BUBBLE_OVER");this.bubble_mobile=this.getLocalizedText("TIP_BUBBLE_TAP");var f=b.browser.device;if(f.name=="ipad"||f.name=="ipod"||f.name=="iphone"||(f.name=="android"&&parseFloat(f.version)>=3)){this.infoText=this.bubble_mobile}else{this.infoText=this.bubble_desktop}this.flyoutView.infoMessage=new b.InfoMessage(this.id,this.tip,this.infoText);this.loadAsset();if(!g){return new b.image.FlyoutZoomViewControl(this)}else{return this}};b.Class.inherits("s7sdk.image.FlyoutZoomView","s7sdk.UIComponent");b.image.FlyoutZoomView.prototype.getComponent=function(){return this};b.image.FlyoutZoomView.ANIM_NONE="none";b.image.FlyoutZoomView.ANIM_WIPE="wipe";b.image.FlyoutZoomView.ANIM_FADE="fade";b.image.FlyoutZoomView.ANIM_SLIDE="slide";b.image.FlyoutZoomView.ANIM_DISSOLVE="dissolve";b.image.FlyoutZoomView.NONE="none";b.image.FlyoutZoomView.MASK="mask";b.image.FlyoutZoomView.COLORIZE="colorize";b.image.FlyoutZoomView.prototype.symbols={TIP_BUBBLE_OVER:"Mouse over to zoom",TIP_BUBBLE_TAP:"Tap and hold to zoom"};b.image.FlyoutZoomView.prototype.modifiers={serverUrl:{params:["isRootPath"],defaults:["/is/image/"]},asset:{params:["asset"],defaults:[""],parseParams:false},iscommand:{params:["value"],defaults:[""],parseParams:false},zoomfactor:{params:["primaryFactor","secondaryFactor","upscale"],defaults:[3,-1,true]},transition:{params:["type","duration"],defaults:[b.image.FlyoutZoomView.ANIM_FADE,1],ranges:[[b.image.FlyoutZoomView.ANIM_NONE,b.image.FlyoutZoomView.ANIM_FADE,b.image.FlyoutZoomView.ANIM_SLIDE],"0:"],deprecated:true},flyouttransition:{params:["type","showtime","showdelay","hidetime","hidedelay"],defaults:[b.image.FlyoutZoomView.ANIM_FADE,1,0,1,0],ranges:[[b.image.FlyoutZoomView.ANIM_NONE,b.image.FlyoutZoomView.ANIM_FADE,b.image.FlyoutZoomView.ANIM_SLIDE],"0:","0:","0:","0:"]},tip:{params:["duration","count","fade"],defaults:[3,1,0.3],ranges:["-1:","-1:","0:"]},preloadtiles:{params:["preloadtilesInitial","preloadtilesResize"],defaults:[false,false]},overlay:{params:["overlay"],defaults:[false]},fmt:{params:["format"],defaults:["jpg"],ranges:[["jpg","jpeg","png","png-alpha","gif","gif-alpha"]]},flyout:{params:["x","y","w","h"],defaults:[0,0,0,0],ranges:[,,"0:","0:"],deprecated:true},size:{params:["width","height"],defaults:[0,0],ranges:["0:","0:"],deprecated:true},highlightMode:{params:["type","showtime","position"],defaults:["highlight",0.1,"onimage"],ranges:[["highlight","cursor"],"0:",["onimage","free"]]},frameTransition:{params:["transition","duration"],ranges:[["none","fade"],"0:"],defaults:["none",0.3]},imageReload:{params:["enabled","type","options","fullscreen"],defaults:[false,"breakpoint","",false],ranges:[,["breakpoint","scale"],,]}};b.image.FlyoutZoomView.RESTRICTED_STYLES={s7flyoutzoomview:["width","height","border"],"s7flyoutzoomview s7flyoutzoom":["width","height","left","top","border"]};b.image.FlyoutZoomView.prototype.setCSS=function(e,d,c){if(this.isRestrictedCSSProperty(b.image.FlyoutZoomView.RESTRICTED_STYLES,d)){throw new Error("You cannot set "+e+" : "+d+" CSS property for this component ")}else{this.superproto.setCSS.apply(this,[e,d,c])}};b.image.FlyoutZoomView.prototype.setModifier=function(c){throw new Error("Trying to use setModifier on the Core class (FlyoutZoomView) is unsupported! Please refer to SDK documentation on using setModifier.")};b.image.FlyoutZoomView.prototype.cleanUp=function(){if(this.flyoutView.infoMessage){this.flyoutView.infoMessage.dispose();this.flyoutView.infoMessage=null}this.flyoutPos=null;this.mainViewPos=null;if(this.flyoutView){this.flyoutView.dispose()}b.Util.removeTags(this.obj);this.obj.style.cssText=""};b.image.FlyoutZoomView.prototype.dispose=function(){this.cleanUp();if(this.obj){if(this.obj.parentElement){this.obj.parentElement.removeChild(this.obj)}}};b.image.FlyoutZoomView.prototype.loadRequest=function(c){this.mediaSet=b.MediaSetParser.parse(c.set,this.imageModifier);if(this.mediaSet.items.length>0&&this.mediaSet.items[0] instanceof b.ItemDesc){this.item=this.mediaSet.items[0];this.asset=this.item.name;this.currentAsset=this.asset;this.configFlyoutZoomView();var d=new b.event.StatusEvent(b.event.StatusEvent.NOTF_ASSET_METADATA_READY,true);b.Event.dispatch(this.obj,d,false)}else{throw new Error("Set response did not contain valid items! Set may be empty.")}};b.image.FlyoutZoomView.prototype.loadAsset=function(){if(!this.asset||this.asset.length==0){return}this.currentAsset=this.asset;var d=b.MediaSetParser.parseAssetForSetReq(this.asset);this.imageModifier=d.mod;this.frame=-1;var c=this.serverUrl+"/"+d.req;if(b.Util.isNonEmptyString(this.locale)){c+="&locale="+this.locale}this.isReq=new b.IS(this.serverUrl,this.asset);this.isReq.getHttpReq(c,function(f,e){b.image.FlyoutZoomView.prototype.loadRequest.apply(e,[f])},null,this)};b.image.FlyoutZoomView.prototype.setAsset=function(d){b.Logger.log(b.Logger.FINE,"s7sdk.image.FlyoutZoomView.setAsset - asset: %0",d);var c=this.asset;if(this.isReq){this.isReq.cancelHttpReq()}if(typeof d!="string"){throw new Error("Asset name must be represented by a string!")}this.asset=d;this.loadAsset();if(c!=null&&this.asset!=null&&this.asset!=""){var e=new b.event.UserEvent(b.event.UserEvent.SWAP,[0,this.asset],true);b.Event.dispatch(this.obj,e,false)}};b.image.FlyoutZoomView.prototype.addEventListener=function(e,d,c){b.Base.prototype.addEventListener.apply(this,[e,d,c])};b.image.FlyoutZoomView.prototype.setItem=function(d){b.Logger.log(b.Logger.FINE,"s7sdk.image.FlyoutZoomView.setItem - item: %0",d);if(this.isReq){this.isReq.cancelHttpReq()}if(d instanceof b.ItemDesc==false){throw new Error("Item must be a descendant of ItemDesc!")}if(d.parent==null){throw new Error("ItemDesc must be part of a parent set!")}this.currentAsset=d;this.mediaSet=d.parent;this.item=d;this.asset=d.name;this.configFlyoutZoomView();var c=new b.event.StatusEvent(b.event.StatusEvent.NOTF_ASSET_METADATA_READY,true);b.Event.dispatch(this.obj,c,false)};b.image.FlyoutZoomView.prototype.mainViewSizePreparation=function(){if(this.mainViewPos.equals(new b.Rectangle(0,0,0,0))){this.left=parseInt(b.Util.css.getCss("s7flyoutzoomview","left",this.compId,null,this.container));this.top=parseInt(b.Util.css.getCss("s7flyoutzoomview","top",this.compId,null,this.container));this.left=isNaN(this.left)?0:this.left;this.top=isNaN(this.top)?0:this.top;if(this.size.width==0||this.size.height==0){var f=parseInt(b.Util.css.getCss("s7flyoutzoomview","border-left-width",this.compId,null,this.container));f=isNaN(f)?0:f;var e=parseInt(b.Util.css.getCss("s7flyoutzoomview","border-right-width",this.compId,null,this.container));e=isNaN(e)?0:e;var d=parseInt(b.Util.css.getCss("s7flyoutzoomview","border-top-width",this.compId,null,this.container));d=isNaN(d)?0:d;var c=parseInt(b.Util.css.getCss("s7flyoutzoomview","border-bottom-width",this.compId,null,this.container));c=isNaN(c)?0:c;this.compSize.width=parseInt(b.Util.css.getCss("s7flyoutzoomview","width",this.compId,null,this.container));this.compSize.height=parseInt(b.Util.css.getCss("s7flyoutzoomview","height",this.compId,null,this.container));this.size.width=this.compSize.width-(f+e);this.size.height=this.compSize.height-(d+c);if(!b.Util.isNumber(this.size.width)||!b.Util.isNumber(this.size.height)||this.size.width<=0||this.size.height<=0){this.size.width=358;this.size.height=478;b.Util.setObjSize(this.obj,this.size.width+(f+e),this.size.height+(d+c));this.compSize.width=this.size.width+2*(f+e);this.compSize.height=this.size.height+2*(d+c)}}else{var f=parseInt(b.Util.css.getCss("s7flyoutzoomview","border-left-width",this.compId,null,this.container));f=isNaN(f)?0:f;var e=parseInt(b.Util.css.getCss("s7flyoutzoomview","border-right-width",this.compId,null,this.container));e=isNaN(e)?0:e;var d=parseInt(b.Util.css.getCss("s7flyoutzoomview","border-top-width",this.compId,null,this.container));d=isNaN(d)?0:d;var c=parseInt(b.Util.css.getCss("s7flyoutzoomview","border-bottom-width",this.compId,null,this.container));c=isNaN(c)?0:c;this.compSize.width=parseInt(b.Util.css.getCss("s7flyoutzoomview","width",this.compId,null,this.container))+(f+e);this.compSize.height=parseInt(b.Util.css.getCss("s7flyoutzoomview","height",this.compId,null,this.container))+(d+c)}this.mainViewPos=new b.Rectangle(this.left,this.top,this.size.width,this.size.height)}this.mainViewPos=this.getComponentBounds()};b.image.FlyoutZoomView.prototype.sizePreparation=function(){if(this.flyoutPos.equals(new b.Rectangle(0,0,0,0))){function d(p,j,l,h,i){if((j=="width")||(j=="left")||(j=="top")||(j=="height")){var m="";var q=b.Util.createElement("div"),r;i=(i&&b.Util.isElement(i))?i:document.body;q.className=p;if(h){r=b.Util.createElement("div");r.className=h;r.appendChild(q)}if(l&&l.length>0){if(h){r.setAttribute("id",l)}else{q.setAttribute("id",l)}}i.appendChild(r||q);m=b.Util.getStyle(q,j);if(/^[-\d\.]+px?$/.test(m)){m=m}else{if(b.browser.name=="ie"&&b.browser.version.major<"11"){if((j=="width")||(j=="left")){var n=q.style.left;var s=q.runtimeStyle.left;q.runtimeStyle.left=q.currentStyle.left;q.style.left=m||0;m=q.style.pixelLeft+"px";q.style.left=n;q.runtimeStyle.left=s}else{var o=q.style.top;var k=q.runtimeStyle.top;q.runtimeStyle.top=q.currentStyle.top;q.style.top=m||0;m=q.style.pixelTop+"px";q.style.top=o;q.runtimeStyle.top=k}}else{switch(j){case"width":m=q.offsetWidth;break;case"height":m=q.offsetHeight;break;case"left":m=q.offsetLeft;break;case"top":m=q.offsetTop;break}}}i.removeChild(r||q);return m}else{return b.Util.css.getCss(p,j,l,h,i)}}this.flyoutPos=new b.Rectangle(this.mainViewPos.width+5,this.mainViewPos.y,600,480);var c=parseInt(d("s7flyoutzoom","width",this.compId,null,this.obj));var f=parseInt(d("s7flyoutzoom","height",this.compId,null,this.obj));var g=parseInt(d("s7flyoutzoom","left",this.compId,null,this.obj));var e=parseInt(d("s7flyoutzoom","top",this.compId,null,this.obj));if(!isNaN(g)){this.flyoutPos.x=g}if(!isNaN(e)){this.flyoutPos.y=e}if(c>0){this.flyoutPos.width=c}if(f>0){this.flyoutPos.height=f}if(!b.Util.isNumber(this.flyoutPos.width)||!b.Util.isNumber(this.flyoutPos.height)||this.flyoutPos.width<=0||this.flyoutPos.height<=0){this.flyoutPos.width=600;this.flyoutPos.height=480}}this.s7anchors=this.findAnchors()};b.image.FlyoutZoomView.prototype.configFlyoutZoomView=function(){if(this.flyoutPos.equals(new b.Rectangle(0,0,0,0))){this.sizePreparation()}if(this.asset==null||this.asset.length<=0){console.log("ERROR: bad configFlyoutZoomView");return}var f=this.asset;function j(m,i,n){m+=((m.indexOf("?")==-1)?"?":"&")+i;m+=(typeof n=="undefined")?"":"="+n;return m}if(b.Util.isNonEmptyString(this.locale)){f=j(f,"locale",this.locale)}if(b.Util.isNonEmptyString(this.item.version)){f=j(f,"id",this.item.version)}function c(m,i){return m-i}function k(m,i){return i-m}if(this.initialSize==null){this.initialSize={width:this.mainViewPos.width,height:this.mainViewPos.height};this.initialFlyoutSize={width:this.flyoutPos.width,height:this.flyoutPos.height}}var d=Math.max(this.item.width/this.initialSize.width,this.item.height/this.initialSize.height);var l=Math.round(this.item.width/d);this.breakpoints=(this.imageReload.enabled&&this.imageReload.type=="breakpoint"&&this.imageReload.options&&this.imageReload.options.split(";").length>0)?this.imageReload.options.split(";"):null;if(this.breakpoints){for(var h=0;h<this.breakpoints.length;h++){this.breakpoints[h]=Math.round(parseInt(this.breakpoints[h],10))}this.breakpoints.push(l);this.breakpoints.sort(c)}else{this.breakpoints=[];this.breakpoints.push(l)}var g=false;for(var h=0;h<this.breakpoints.length;h++){if(this.breakpoints[h]==this.item.width){g=true;break}}this.breakpoints.sort(c);for(var h=0;h<this.breakpoints.length;h++){if(this.breakpoints[h]>this.item.width){if(g){this.breakpoints.splice(h,1);h--}else{this.breakpoints[h]=this.item.width;g=true}}}this.calcAdjustedZoomFactors();var e=false;if(this.preloadtiles.preloadtilesInitial){e=true}this.flyoutView.firstInit=true;this.flyoutView.loadImage(f,this.serverUrl,this.mainViewPos,this.flyoutPos,this.adjustedZoomFactors.primaryFactor,this.transition.type,this.transition.duration,e,this.fmt,this.iscommand,this.adjustedZoomFactors.secondaryFactor,this.overlay);this.settings.trackLoad(this)};b.image.FlyoutZoomView.prototype.getComponentBounds=function(){return new b.Rectangle(this.left,this.top,this.size.width,this.size.height)};b.image.FlyoutZoomView.prototype.getWidth=function(){return this.size.width};b.image.FlyoutZoomView.prototype.getHeight=function(){return this.size.height};b.image.FlyoutZoomView.prototype.resize=function(n,r){this.compSize.width=n;this.compSize.height=r;var g=parseInt(b.Util.css.getCss("s7flyoutzoomview","border-left-width",this.compId,null,this.container));g=isNaN(g)?0:g;var f=parseInt(b.Util.css.getCss("s7flyoutzoomview","border-right-width",this.compId,null,this.container));f=isNaN(f)?0:f;var o=parseInt(b.Util.css.getCss("s7flyoutzoomview","border-top-width",this.compId,null,this.container));o=isNaN(o)?0:o;var m=parseInt(b.Util.css.getCss("s7flyoutzoomview","border-bottom-width",this.compId,null,this.container));m=isNaN(m)?0:m;n=n-(g+f);r=r-(o+m);function i(w){var h=[];h.push({x:w.x,y:w.y});h.push({x:w.x+w.width,y:w.y});h.push({x:w.x+w.width,y:w.y+w.height});h.push({x:w.x,y:w.y+w.height});return h}function l(h){return{x:h[0].x,y:h[0].y,width:h[1].x-h[0].x,height:h[2].y-h[0].y}}function k(B,y,x,h){var C=i(B);var D=[];for(var z=0;z<C.length;z++){var A=C[z];var w={x:y.x+x*(A.x-y.x),y:y.y+h*(A.y-y.y)};D.push(w)}return l(D)}function u(x,w,h){return{x:x.x+w,y:x.y+h,width:x.width,height:x.height}}function c(w,h){return{x:w.x+h.relX*w.width,y:w.y+h.relY*w.height}}function v(z,x,A,B,h){var w=c(A,h.main);A=k(A,{x:A.x,y:A.y},z,x);var y=c(A,h.main);B=u(B,y.x-w.x,y.y-w.y);var C=c(B,h.flyout);B=k(B,C,z,x);return{main:A,flyout:B}}var t=n/this.mainViewPos.width;var s=r/this.mainViewPos.height;if((t==1)&&(s==1)){return}if(this.flyoutPos.equals(new b.Rectangle(0,0,0,0))){var q=k(this.mainViewPos,{x:this.mainViewPos.x,y:this.mainViewPos.y},t,s);this.mainViewPos=new b.Rectangle(q.x,q.y,q.width,q.height);this.left=this.mainViewPos.x;this.top=this.mainViewPos.y;this.size.width=this.mainViewPos.width;this.size.height=this.mainViewPos.height;b.Util.setObjSize(this.obj,this.mainViewPos.width,this.mainViewPos.height);return}var e=v(t,s,this.mainViewPos,this.flyoutPos,this.s7anchors);this.mainViewPos=new b.Rectangle(e.main.x,e.main.y,e.main.width,e.main.height);this.left=this.mainViewPos.x;this.top=this.mainViewPos.y;this.size.width=this.mainViewPos.width;this.size.height=this.mainViewPos.height;this.flyoutPos=new b.Rectangle(e.flyout.x,e.flyout.y,e.flyout.width,e.flyout.height);if(this.asset==null||this.asset.length<=0){}else{var p=this.asset;function d(w,h,x){w+=((w.indexOf("?")==-1)?"?":"&")+h;w+=(typeof x=="undefined")?"":"="+x;return w}if(b.Util.isNonEmptyString(this.locale)){p=d(p,"locale",this.locale)}if(b.Util.isNonEmptyString(this.item.version)){p=d(p,"id",this.item.version)}this.flyoutView.firstInit=true;var j=false;if(this.preloadtiles.preloadtilesInitial&&this.preloadtiles.preloadtilesResize){j=true}else{if(this.preloadtiles.preloadtilesInitial&&!this.preloadtiles.preloadtilesResize){j=false}}this.flyoutView.loadImage(p,this.serverUrl,this.mainViewPos,this.flyoutPos,this.adjustedZoomFactors.primaryFactor,this.transition.type,this.transition.duration,j,this.fmt,this.iscommand,this.adjustedZoomFactors.secondaryFactor,this.overlay);this.settings.trackLoad(this)}};b.image.FlyoutZoomView.prototype.prepareUnload=function(){this.size.width=this.compSize.width;this.size.height=this.compSize.height};b.image.FlyoutZoomView.prototype.findAnchors=function(){var k={relX:0,relY:0};var h={relX:0,relY:0};var g=!((this.flyoutPos.x>=this.mainViewPos.x+this.mainViewPos.width)||(this.flyoutPos.x+this.flyoutPos.width<=this.mainViewPos.x));var d=!((this.flyoutPos.y>=this.mainViewPos.y+this.mainViewPos.height)||(this.flyoutPos.y+this.flyoutPos.height<=this.mainViewPos.y));function c(m){var l=[];l.push({x:m.x,y:m.y});l.push({x:m.x+m.width,y:m.y});l.push({x:m.x+m.width,y:m.y+m.height});l.push({x:m.x,y:m.y+m.height});return l}function j(l){switch(l){case 0:return{relX:0,relY:0};case 1:return{relX:1,relY:0};case 2:return{relX:1,relY:1};case 3:return{relX:0,relY:1}}}function i(m,l){return Math.pow(Math.pow(m.x-l.x,2)+Math.pow(m.y-l.y,2),0.5)}function e(r,q){var n=c(r);var l=c(q);var p=[-1,-1];for(var o=0;o<4;o++){for(var m=0;m<4;m++){if((p[0]==-1)||(i(n[p[0]],l[p[1]])>i(n[o],l[m]))){p[0]=o;p[1]=m}}}return p}if(!g&&!d){var f=e(this.mainViewPos,this.flyoutPos);k=j(f[0]);h=j(f[1])}else{if(g&&d){k={relX:0.5,relY:0.5};h={relX:0.5,relY:0.5}}else{if(g){if(this.flyoutPos.y>this.mainViewPos.y){k={relX:0.5,relY:1};h={relX:0.5,relY:0}}else{k={relX:0.5,relY:0};h={relX:0.5,relY:1}}}else{if(this.flyoutPos.x>this.mainViewPos.x){k={relX:1,relY:0.5};h={relX:0,relY:0.5}}else{k={relX:0,relY:0.5};h={relX:1,relY:0.5}}}}}return({main:k,flyout:h})};b.image.FlyoutZoomView.prototype.calcAdjustedZoomFactors=function(){var d;var c;if((this.zoomfactor.upscale==0)&&((this.initialSize.height>this.item.height)&&(this.initialSize.width>this.item.width))){d=this.item.width;c=this.item.height}else{c=this.initialSize.height;d=Math.round(this.item.width*c/this.item.height);if(d>this.initialSize.width){d=this.initialSize.width;c=Math.round(this.item.height*d/this.item.width)}}var e;if(this.initialFlyoutSize.width*c/this.initialFlyoutSize.height<d){e=this.initialFlyoutSize.height/c}else{e=this.initialFlyoutSize.width/d}this.adjustedZoomFactors.primaryFactor=this.zoomfactor.primaryFactor>e?this.zoomfactor.primaryFactor:e;if(this.zoomfactor.secondaryFactor>0){this.adjustedZoomFactors.secondaryFactor=this.zoomfactor.secondaryFactor>e?this.zoomfactor.secondaryFactor:e}else{this.adjustedZoomFactors.secondaryFactor=-1}if(this.zoomfactor.upscale==0){if((this.adjustedZoomFactors.primaryFactor*c>this.item.height)&&(this.adjustedZoomFactors.primaryFactor*d>this.item.width)){this.adjustedZoomFactors.primaryFactor=Math.max(1/(d/this.item.width),1)}if((this.adjustedZoomFactors.secondaryFactor*c>this.item.height)&&(this.adjustedZoomFactors.secondaryFactor*d>this.item.width)){this.adjustedZoomFactors.secondaryFactor=Math.max(1/(d/this.item.width),1)}}};b.image.FlyoutZoomView.prototype.getCurrentAsset=function(){return typeof this.currentAsset=="undefined"?null:this.currentAsset};b.image.FlyoutZoomView.prototype.setCurrentAsset=function(c){if(typeof(c)=="string"){this.setAsset(c)}else{this.setItem(c)}};b.FlyoutZoomView=b.image.FlyoutZoomView;(function a(){var f=b.Util.css.createCssRuleText;var e=b.Util.css.createCssImgUrlText;var d=b.browser&&b.browser.name=="ie"&&b.browser.version.major>=10;var c=f(".s7flyoutzoomview",{position:"relative",width:"360px",height:"480px",border:"1px solid #c2c2c2","-moz-user-select":"-moz-none","-webkit-user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","-ms-user-select":"none","user-select":"none","text-align":"left","-ms-touch-action":d?"none":"","touch-action":d?"none":""})+f(".s7flyoutzoomview img",{width:"auto","max-width":"none !important","max-height":"none !important"})+f(".s7flyoutzoomview .s7highlight",{opacity:"0.6",filter:"alpha(opacity = 60)","background-color":"#FFFFFF"})+f(".s7flyoutzoomview .s7cursor[input='mouse']",{width:"80px",height:"80px","background-image":e("zoom-cursor-desktop.png")})+f(".s7flyoutzoomview .s7cursor[input='touch']",{width:"80px",height:"100px","background-image":e("zoom-cursor-tablet-1x.png")})+f(".s7flyoutzoomview .s7overlay",{opacity:"0.6",filter:"alpha(opacity = 60)","background-color":"#FFFFFF"})+f(".s7flyoutzoomview .s7flyoutzoom",{width:"600px",height:"480px",left:"365px",top:"0px",position:"absolute",border:"1px solid #c2c2c2","-webkit-transform":"translateZ(0px)"})+f(".s7flyoutzoomview .s7tip",{position:"absolute",bottom:"50px",color:"#ffffff","font-family":"Arial","font-size":"12px","padding-bottom":"10px","padding-top":"10px","padding-left":"12px","padding-right":"12px","background-color":"#000000","border-radius":"4px","-webkit-transform":"translateZ(0px)",opacity:"0.5",filter:"alpha(opacity = 50)"});b.Util.css.addDefaultCSS(c,"FlyoutZoomView")})()}if(!b.InfoMessage){b.InfoMessage=function(d,c,f,e){e=(typeof e=="string"&&e.length)?e:"InfoMessage_"+b.Util.createUniqueId();arguments.callee.superclass.apply(this,[e,d,"div","s7tip"]);this.createElement();this.baseOpacity=null;this.currentOpacity=0;this.hiddenState=true;this.enabled=true;this.textType=f||this.textType;if(c){this.tip=c}else{this.tip.duration=3;this.tip.count=1;this.tip.fade=0.3}this.obj.innerHTML=this.textType;this.obj.style.display="none";this.appended=null;this.timerId=null};b.Class.inherits("s7sdk.InfoMessage","s7sdk.UIComponent");b.InfoMessage.prototype.show=function(f,e){if(!this.hiddenState||this.tip.count==0||!this.enabled){return}if(this.tip.count>0){this.tip.count--}this.hiddenState=false;this.container=this.getParent();this.obj.style.display="block";if(!this.appended){this.appended=this.container.appendChild(this.obj)}if(this.baseOpacity==null){this.baseOpacity=b.Util.getStyle(this.obj,"opacity")}this.centerOverlay(f||this.container.offsetWidth,e||this.container.offsetHeight);var d=this;function c(){if(d.currentOpacity<1&&!d.hiddenState){d.currentOpacity+=0.05/d.tip.fade;d.obj.style.opacity=d.baseOpacity*d.currentOpacity;d.obj.style.filter="alpha(opacity ="+(d.baseOpacity*d.currentOpacity*100)+")";d.timerId=setTimeout(c,50)}}if(this.tip.fade>0){c()}else{this.obj.style.opacity=this.baseOpacity;this.obj.style.filter="alpha(opacity ="+(this.baseOpacity*100)+")"}};b.InfoMessage.prototype.hide=function(){if(this.hiddenState){return}this.hiddenState=true;var c=this;function d(){if(c.hiddenState){if(c.currentOpacity>0){c.currentOpacity-=0.05/c.tip.fade;c.obj.style.opacity=c.baseOpacity*c.currentOpacity;c.obj.style.filter="alpha(opacity ="+(c.baseOpacity*c.currentOpacity*100)+")";c.timerId=setTimeout(d,50)}else{c.obj.style.opacity=0;c.obj.style.display="none"}}}if(this.tip.fade>0){d()}else{this.obj.style.opacity=0;this.obj.style.filter="";this.obj.style.display="none"}};b.InfoMessage.prototype.centerOverlay=function(d,c){this.obj.style.left=0+"px";this.obj.style.left=(d-this.obj.offsetWidth)/2+"px"};b.InfoMessage.prototype.stop=function(){if(this.timerId){clearTimeout(this.timerId);this.timerId=null}};b.InfoMessage.prototype.dispose=function(){this.stop();if(this.obj){if(this.obj.parentElement){this.obj.parentElement.removeChild(this.obj)}}}}})(s7getCurrentNameSpace());